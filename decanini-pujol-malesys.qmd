---
title: "Rapport de projet Statistiques & Analyses de données"
author: 
  - name: "Adam Malesys"
  - name: "Amélie Pujol"
  - name: "Marin Decanini"
date: "`r Sys.Date()`"
bibliography: exbiblio.bib
format: 
  pdf:
    toc: TRUE
    toc_depth: 2
    number-sections: true
    header-includes:
    - \usepackage{color}
    - \newcommand{\X}{\mathbf{X}}
execute: 
  warning: false
  message: false
---

```{r}
#| echo: false

library(ggplot2)
library(corrplot)
library(FactoMineR)
library(factoextra)
library(gridExtra)
library(knitr)
library(reshape2)
```

# Etude du jeu de données

```{r}
#| echo: false
#| label: tbl-datagym
#| tbl-cap: "Les premières lignes du jeu de données DataGym"

Data = read.table("DataGym-projet4modIA-2526.csv",header=TRUE)
```

```{r}
Data$type=as.factor(Data$type)
Data$level=as.factor(Data$level)
Data$gender=as.factor(Data$gender)
```

Les données sont composées de `973` individus, de 3 variables **qualitatives** `type`, `gender` et `level`, et de `10` autres variables **quantitatives**

## Statistiques descriptives

### Variables quantitatives

Pour étudier les corrélations et liaisons entre les variables, nous étudions d'abord la matrice de corrélation des variables quantitatives :

```{r}
#| echo: false
#| label: tbl-datagym
#| tbl-cap: "Les premières lignes du jeu de données DataGym"

Data = read.table("DataGym-projet4modIA-2526.csv",header=TRUE)
```

```{r}
corrplot(cor(Data[,-c(2,8,12)]), method="ellipse", type="lower")
```

Certaines variables sont fortement corrélées, comme `bmi` et `weight` ou `fat` et `calories`. Cela justifie l'utilisation d'une ACP pour réduire la dimensionnalité du jeu de données. Cependant, beaucoup de ces variables n'étant pas corrélées du tout, on ne pourra pas projeter les individus dans un espace de très faible dimension.

### Les 3 variables qualitatives

```{r}
#| echo: false
#| fig-cap: "Barplot des variables qualitatives"
#| label: fig-species
#| fig-height: 2

ggplot(Data,aes(x=type))+
  geom_bar()

ggplot(Data,aes(x=gender))+
  geom_bar()

ggplot(Data,aes(x=level))+
  geom_bar()
```

On remarque que le jeu de données est assez équilibré en terme de genre ou de type de sport, cependant il y a peu d'individus de niveau 3.

### Relations qualitatives-quantitatives

```{r}
#| echo: false
#| eval: false
#| fig-cap: "Barplot des relations quantitatives-qualitatives"
#| fig-height: 2

ggplot(Data, aes(x=gender, y=bmi, fill=gender)) + geom_boxplot()
ggplot(Data, aes(x=type, y=calories, fill=type)) + geom_boxplot()

# TODO CHOISIR LESQUELS AFFICHER

ggplot(Data,aes(x=type,y=calories)) +
  geom_violin() +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)

ggplot(Data,aes(x=gender,y=bmi)) +
  geom_violin() +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)

ggplot(Data,aes(x=gender,y=bmi)) +
  geom_violin() +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)

ggplot(Data,aes(x=gender,y=bmi)) +
  geom_violin() +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)
```

différents profils: en fonction du type \> différente répartition des IMC (strength souvent + lourds)

## ACP

## MCA

Nous nous intéressons maintenant aux 4 variables quantitatives (matrice $X$). La @fig-corrplot montre les corrélations entre les 4 variables. On peut remarquer que la largeur et la longuer des pétales sont fortement corrélées positivement, ce n'est pas le cas pour les sépales.

```{r}
#| echo: false
#| label: fig-corrplot
#| fig-cap: "Matrice des corrélations entre les 4 variables quantitatives"
#| fig-height: 3
```

A l'aide de la librairie `FactoMineR`, on met en place une ACP. On représente en @fig-ACP les individus projetés sur le premier plan factoriel, la couleur correspondant à l'espèce ainsi que les corrélations des variables quantitatives initiales avec les deux premières composantes principales. Non Marin c'est nul

```{r}
#| fig-height: 5
#| layout-ncol: 2
#| label: fig-ACP
#| fig-cap: Résultats de l'ACP
#| fig-subcap: 
#|   - "Projection des individus dans le premier plan factoriel"
#|   - "Corrélation entre les variables et les deux premières composantes principales"
fviz_pca_ind(respca,label="none",habillage=5)+
  theme(legend.position="bottom")
fviz_pca_var(respca) 
```

On peut remarquer que les *Setosa* se distinguent des deux autres espèces principalement par la largeur de leur sépales. On peut appuyer ce point à l'aide de la @fig-violin.

```{r}
#| echo: false
#| fig-height: 3
#| message: false
#| label: fig-violin
#| fig-cap: "Violin plots de la largeur des sépales pour chaque espèce"
```

# References
